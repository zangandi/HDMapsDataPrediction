from fmm import Network,NetworkGraph,STMATCH,STMATCHConfig
network = Network("xian_1001_aligned.shp")
graph = NetworkGraph(network)
print graph.get_num_vertices()
model = STMATCH(network,graph)
wkt = "LINESTRING(34.23552 108.93405,34.23552 108.93405,34.23552 108.93405,34.23552 108.93405,34.23552 108.93405,34.23552 108.93405,34.23552 108.93405,34.23552 108.93405,34.23552 108.93395,34.23552 108.93395,34.23552 108.93395,34.23552 108.93395,34.23552 108.93406,34.23553 108.93415,34.23553 108.93438,34.23553 108.93452,34.23554 108.93474,34.23554 108.93498,34.23555 108.93523,34.23555 108.93554,34.23556 108.93581,34.23555 108.93605,34.23555 108.93628,34.23555 108.93653,34.23555 108.93683,34.23555 108.93701,34.23554 108.93746,34.23554 108.93776,34.23554 108.93800,34.23554 108.93828,34.23554 108.93855,34.23554 108.93855,34.23554 108.93870,34.23554 108.93870,34.23554 108.93870,34.23554 108.93883,34.23554 108.93883,34.23554 108.93883,34.23549 108.93898,34.23549 108.93898,34.23529 108.93898,34.23515 108.93899,34.23498 108.93913,34.23499 108.93928,34.23499 108.93953,34.23499 108.93969,34.23499 108.93978,34.23499 108.93988,34.23500 108.94011,34.23500 108.94039,34.23501 108.94071,34.23501 108.94097,34.23501 108.94114,34.23501 108.94114,34.23502 108.94150,34.23502 108.94169,34.23503 108.94197,34.23503 108.94214,34.23503 108.94214,34.23503 108.94230,34.23503 108.94230,34.23503 108.94230,34.23504 108.94249,34.23504 108.94249,34.23504 108.94288,34.23504 108.94304,34.23504 108.94314,34.23504 108.94330,34.23505 108.94349,34.23504 108.94358,34.23504 108.94358,34.23504 108.94415,34.23504 108.94442,34.23504 108.94471,34.23504 108.94498,34.23503 108.94530,34.23503 108.94563,34.23503 108.94589,34.23503 108.94617,34.23503 108.94643,34.23503 108.94660,34.23487 108.94676,34.23465 108.94676,34.23440 108.94676,34.23416 108.94676,34.23397 108.94675,34.23379 108.94675,34.23352 108.94675,34.23326 108.94675,34.23303 108.94675,34.23290 108.94675,34.23279 108.94675,34.23271 108.94675,34.23258 108.94674,34.23248 108.94674,34.23248 108.94674,34.23238 108.94674,34.23238 108.94674)"
config = STMATCHConfig()
config.k = 4
config.gps_error = 0.5
config.radius = 0.4
config.vmax = 30;
config.factor =1.5
result = model.match_wkt(wkt,config)
print type(result)
print "Opath ",list(result.opath)
print "Cpath ",list(result.cpath)
print "WKT ",result.mgeom.export_wkt()
